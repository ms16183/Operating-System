# オペレーティングシステムの役割
- 演算装置: データに対する演算を行う．
- 制御装置: 核装置を制御する制御信号を出す．
- 記憶装置: プログラムやデータを記憶する．
- 入力装置: コンピュータに外部からデータを入力する．
- 出力装置: コンピュータから外部にデータを出力する．

- LSI: Large Scale Integrated circuit．1チップの大規模集積回路．
- MPU: Licro Processing Unit．マイクロプロセッサ．
- 4004: 1971年にIntelがリリースした4bitCPU．
- 8086: 1978年に8bitCPU．x86の基礎．

# 主記憶装置
- 揮発性メモリ RAM(Random Access Memory)
  - DRAM(Dynamic RAM)
  - SRAM(Static RAM)

- 不揮発性メモリ ROM(Read Only Memory)
  - マスクROM
  - PROM(Programmable ROM)
  - EPROM(Erastable PROM)
  - EEPROM(Electrical EPROM)

# 補助記憶装置
- 補助記憶装置
  - HDD(Hard Disk Drive)
  - SSD(Solid State Drive)
  - ODD(Optical Disk Drive)

# OS
アプリケーションプログラムにとって容易かつ効率的に利用可能とする一連のプログラムのこと．基本プログラムと呼ぶ．
ハードウェアリソース: CPU，メモリ，入出力装置
ソフトウェアリソース: ソフト腕あの使用権など
応用プログラム: ブラウザ，ワープロソフト，シェル
オペーレーティングシステムの目的: **"容易性"と"効率性"の向上**

# 容易性
- ハードウェアへのアクセス
  - プログラム側がハードウェア操作しやすくなるインテーフェイスを用意．
  - 入出力装置に対する簡単なアクセス．
- ハードウェアリソースの確保
  - プログラム別にハードウェアリソースの確保に対する制御．
  - 仮想化による無数のハードウェアリソースを提供する．

# 効率性
- ハードウェアリソースの共有
  - プログラムアクセス時の適切なスケジューリング
- ソフトウェアリソース管理
  - 最低限のソフトウェア実行，ソフトウェアリソースのバージョン管理
- プログラミング作成支援
  - ライブラリ管理，ユーザインターフェイス支援．
- 統合的なコンピュータシステム環境
  - ネットワークに結合したコンピュータのハードウェア・ソフトウェアリソース．
    - 例えばプリンタ．LAN内のPCから印刷できる．

# ハードウェアリソースの多重化と効率化
- 時分割多重化
  - 時間軸で多重化．ハードウェアリソースを複数プログラムに交互利用．
- 空間分割多重化
  - 空間軸場での多重化．ハードウェアリソースを複数の領域に区切り各プログラムに割り当てる．
    - メモリはこの例である．

- バッチ処理: プログラム実行前に一括投入されたジョブに含まれる情報のみによって処理を行う方式．
  - ターンアラウンドタイム: ジョブが待ち行列に投入されてから終了するまでの時間．
  - 実行に必要なリソースが小さいジョブを優先すると平均TATが少なくなって効率的である．
- インタラクティブ処理: プログラム実行中ウニ入力が必要となった時，ユーザの入力を行いプログラムの実行を制御する処理方式．
  - スループット: コンピュータが多重に間に行う仕事量．
  - TSS: 複数のプロセスに非常に短い時間単位でCPUの実行権を与えて，各プロセスにCPUを占有させているように見せかける仮想化手法．
  - レスポンスタイム; インタラクティブな入力を受けて処理結果を返却するまでの時間．
  - スパコンではバッチ処理が優先される．メインフレームでは対話処理にリソースを優先．

# リアルタイム処理
- ジョブやプロセスが発生し，決められた時間内に実行を保証．
- レスポンスタイムの変動要素をできる限り排除．
- リアルタイム性を担保できるハードウェアリソース．
  - 工場のロボット制御．
  - 音声・映像のメディア処理．
  - ATMシステム，飛行機の予約システム．

# 分散処理
- ネットワークを通じて複数のコンピュータを同時に用いて処理を行う．
- クライアントサーバモデル．
- コンピュータ間でのファイル共有．
- 分散コンピューティング．

# CPUの仮想化

# プロセスとその処理形態
- プロセス: 実行プログラムに対するリソースの割り当て単位
- ユニプロセッサ・ユニプログラミング方式
  - 1個のCPU上で一つのプロセスの開始から終了までを継続して処理する．
- ユニプロセッサ・マルチプログラミング方式
  - 主記憶内に複数のプログラムを格納し，入出力の完了またはOSからの命令によりプログラムを切り替えて実行する．
- マルチプロセッサ・マルチプログラミング方式
  - 複数のCPUを備えたコンピュータを対象とし，複数CPUで同時にプログラムを実行する．
- スレッド・CPUリソースを論理的な単位で割り当て
  - プロセスは多数のスレッドを内部に生成できる．
  - 複数スレッドは同時実行される複数の実行ポイントが存在する．
  - プログラムに並列性がある場合，一つのプロセス内で同時に複数CPUを使用可能．

# プロセスの状態
- 実行状態(running)
  - CPUリソースを含む実行に必要なすべてのリソースが確保され，プロセスを実行している状態．
- 実行可能状態(ready)
  - CPUリソースさえ確保できればプロセスを実行可能な状態．
- 待ち状態(wait)
  - CPU以外に実行に必要なリソースが確保されていない状態．

# 割り込み
- 割り込み処理
  - CPUが高速化つ軽量にイベントを処理するプログラム実行方式．
    - イベントは，CPU内で通常の計算処理以外の事象．
  - 内部割り込み
    - SVC割り込み
    - プログラムチェック割り込み
  - 外部割り込み
    - 入出力割り込み
    - タイマ割り込み
    - マシンチェック割り込み
    - リスタート割り込み
- 実行速度の差
  - 人の反応速度: 約10^(-1) sec
  - HDDのR/W速度: 約10^(-3) sec
  - メモリのR/W速度: 約10^(-7) sec
  - CPUの1命令実行速度: 約10^(-9) sec

# スーパバイザコール割り込み
- スーパバイザコール(SVC)割り込み
  - ユーザプログラムがOSに対して処理を依頼する際に発生する割り込み．
  - 入出力関数内でSVC割り込みを呼び出し，OSへ処理を依頼する．
  - スーパバイザモード
    - OSを実行するモードをCPUが有するすべての命令とOSが管理するすべてのリソースを利用可能．
  - ユーザモード
    - ユーザが作成した応用プログラムを実行するモード．実行できる命令や利用リソースに制限あり．
- プログラムチェック割り込み(例外割り込み)
 - 実行中のプログラムで異常が発生した時に発生する割り込み．
  - ゼロ除算
  - オーバーフロー
  - 不正アドレスアクセス
- プログラム実行時の異常を適切に対処することが可能．

# 外部割り込み
- 入出力割り込み
  - 入出力装置から発生する割り込み．
  - ISが2次記憶装置に書き込み依頼し，書き込みが終了した際に発生する2次記憶装置からの割り込み．
- タイマ割り込み
  - タイムシェアリングシステムにおいて，各プロセスに割り当てられたクオンタムの終了時など，時間を制御するインターバルタイマによる割り込み．
- マシンチェック割り込み
  - ハードウェアによって通知される異常．
    - CPU温度上昇
    - 冷却装置の異常，
    - その他電源などの異常
- リスタート割り込み
  - コンピュータシステムをリスタート(リセット)する際に発生する割り込み．

# 割り込みによるプロセスの中断と再開
- 割り込みが発生すると，実行中のプロセスが中断され，割り込み処理ルーチン(割り込みハンドラ，割り込み処理プログラム)が実行される．
  1. プロセスAがCPUスケジューラに対して入出力命令を依頼して割り込みが発生(SVC命令)．

# スレッド
- CPUリソースのみを独立に割り当てる．
  - マルチスレッド
    - 各スレッドは独自にレジスタ軍とスタックを持ち，CPUリソースを割り当てる．
    - プロセス内で管理される主記憶，プログラム領域，静的変数領域，動的変数領域，PSWが各スレッド間で共有する．
    - ファイル情報もプロセス単位で管理する．
    - CPU内に複数のコアがある場合，それぞれでスレッドを作成し，並列実行が可能．

# 実行中のプロセスの中断方式
- プリエンプション方式
  - OSが実行中のプロセスの実行権を強制的に取り上げプロセスを中断する．
  - プリエンティブなマルチタスク(Win, Mac, UNIXが採用)

- ノンプリエンプション方式
  - OSではなく実行中のプロセスが自主的にCPUリソースをOSに戻す．
  - プログラムが暴走した場合，プロセスが自主的にCPUリソースを変換できずシステム団の可能性あり．
  - ノンプリエンプテなマルチタスク(Win95, MacOS9が採用)

- OSの効率性は，CPUスケジューリングアルゴリズムの性能でほぼ決定する．
  - 理想は応答時間・待ち時間が最小，CPU使用率・スループットが最大．
- CPUリソースは時間分割し仮想化する．
  - プロセスの切り替えが増加．
  - 次に実行するプロセスを選択する操作も増加．
- 切り替えによるオーバヘッドの増加．
  - コンピュータシステムのスループットが低下．
  - スケジューリング方法でオーバーヘッドの増減を調整．

- スケジューリングアルゴリズムの効率化の指標
  - 応答時間
    - ターンアラウンドタイム: パッチ処理におけるジョブ投入から結果受け取りまでの時間．
    - レスポンスタイム: 対話処理における端末からの入力から結果受け取りまでの時間．
  - スループット
    - CPUが単位時間に行うユーザに有益な仕事量．
    - プロセス切り替えなどのオーバヘッドは含まれない．
    - 入出力操作やコンテキスト切り替えなどを提言し計算処理にCPUリソースを用いるとスループットが向上．
  - 待ち時間
    - プロセスが完了するまでに実行可能キューで待つ時間(実行可能状態から実行できるまでの時間)
  - CPU使用率
    - CPUの動作時間 / システム稼働時間


